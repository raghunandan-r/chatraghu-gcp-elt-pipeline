[0m21:59:56.609715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9c3cbf090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9c2d2b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9c2984b50>]}


============================== 21:59:56.611749 | 4c991132-05cd-4407-8350-34d070fa55b6 ==============================
[0m21:59:56.611749 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:59:56.612112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:59:56.618628 [info ] [MainThread]: dbt version: 1.8.0
[0m21:59:56.618917 [info ] [MainThread]: python version: 3.11.2
[0m21:59:56.619160 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:59:56.619422 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:59:57.171573 [info ] [MainThread]: Using profiles dir at .
[0m21:59:57.172061 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m21:59:57.172363 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:59:57.172640 [info ] [MainThread]: adapter type: bigquery
[0m21:59:57.172879 [info ] [MainThread]: adapter version: 1.8.0
[0m21:59:57.232779 [info ] [MainThread]: Configuration:
[0m21:59:57.233203 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:59:57.233434 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:59:57.233642 [info ] [MainThread]: Required dependencies:
[0m21:59:57.233849 [debug] [MainThread]: Executing "git --help"
[0m21:59:57.235759 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:59:57.236050 [debug] [MainThread]: STDERR: "b''"
[0m21:59:57.236208 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:59:57.236402 [info ] [MainThread]: Connection:
[0m21:59:57.236597 [info ] [MainThread]:   method: oauth
[0m21:59:57.236794 [info ] [MainThread]:   database: subtle-poet-311614
[0m21:59:57.237024 [info ] [MainThread]:   execution_project: subtle-poet-311614
[0m21:59:57.237232 [info ] [MainThread]:   schema: analytics
[0m21:59:57.237460 [info ] [MainThread]:   location: us-east1
[0m21:59:57.237647 [info ] [MainThread]:   priority: interactive
[0m21:59:57.237849 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:59:57.238023 [info ] [MainThread]:   impersonate_service_account: None
[0m21:59:57.238205 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:59:57.238390 [info ] [MainThread]:   job_retries: 1
[0m21:59:57.238544 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:59:57.238720 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:59:57.238894 [info ] [MainThread]:   timeout_seconds: None
[0m21:59:57.239065 [info ] [MainThread]:   client_id: None
[0m21:59:57.239235 [info ] [MainThread]:   token_uri: None
[0m21:59:57.239474 [info ] [MainThread]:   dataproc_region: None
[0m21:59:57.239650 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:59:57.239815 [info ] [MainThread]:   gcs_bucket: None
[0m21:59:57.239977 [info ] [MainThread]:   dataproc_batch: None
[0m21:59:57.240300 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m21:59:57.242728 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:59:57.242953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:57.245299 [debug] [MainThread]: On debug: select 1 as id
[0m21:59:58.617693 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:e297d960-c356-4aeb-b57b-51977a5a77a6&page=queryresults
[0m21:59:58.955535 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:59:58.956465 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:59:58.958462 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.3811274, "process_user_time": 1.611187, "process_kernel_time": 1.658926, "process_mem_max_rss": "197096", "process_in_blocks": "272", "process_out_blocks": "48"}
[0m21:59:58.959609 [debug] [MainThread]: Command `dbt debug` succeeded at 21:59:58.959233 after 2.38 seconds
[0m21:59:58.960206 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:59:58.960755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9c27cacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b998b678d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9909d1510>]}
[0m21:59:58.961339 [debug] [MainThread]: Flushing usage events
[0m23:41:39.060704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4d98cc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4d98cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4d98ce410>]}


============================== 23:41:39.062931 | 8a6369b7-66d0-4e42-a7b5-a3005a0e9941 ==============================
[0m23:41:39.062931 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:41:39.063330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:41:39.674228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a6369b7-66d0-4e42-a7b5-a3005a0e9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4afbd6090>]}
[0m23:41:39.709617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a6369b7-66d0-4e42-a7b5-a3005a0e9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4db627cd0>]}
[0m23:41:39.710229 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m23:41:39.718590 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:41:39.719111 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:41:39.719429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a6369b7-66d0-4e42-a7b5-a3005a0e9941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4a35526d0>]}
[0m23:41:40.412452 [error] [MainThread]: Encountered an error:
Compilation Error in model retrieved_docs (models/retrieved_docs.sql)
  expected token ',', got 'score'
    line 11
      unique_key=['run_id', 'thread_id', 'turn_index', 'timestamp_start', 'score'] -- Added score to key for uniqueness
[0m23:41:40.413572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3846978, "process_user_time": 2.200711, "process_kernel_time": 1.73112, "process_mem_max_rss": "200752", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:41:40.414002 [debug] [MainThread]: Command `dbt run` failed at 23:41:40.413923 after 1.39 seconds
[0m23:41:40.414252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4a3236f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4d98c26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4a3217ad0>]}
[0m23:41:40.414509 [debug] [MainThread]: Flushing usage events
[0m23:43:39.427133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772e23fbe750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772e24366f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772e243670d0>]}


============================== 23:43:39.429210 | 4a68bfb4-4adf-468d-b23e-07f634fe965b ==============================
[0m23:43:39.429210 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:43:39.429584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:43:40.105277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a68bfb4-4adf-468d-b23e-07f634fe965b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772dedd16990>]}
[0m23:43:40.141657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a68bfb4-4adf-468d-b23e-07f634fe965b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772e25d13f50>]}
[0m23:43:40.142247 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m23:43:40.149252 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:43:40.149728 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:43:40.150003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a68bfb4-4adf-468d-b23e-07f634fe965b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772deeb2b050>]}
[0m23:43:40.860207 [error] [MainThread]: Encountered an error:
Compilation Error in model retrieved_docs (models/retrieved_docs.sql)
  expected token ',', got 'score'
    line 11
      unique_key=['run_id', 'thread_id', 'turn_index', 'timestamp_start', 'doc_score'] -- Added score to key for uniqueness
[0m23:43:40.861104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.466053, "process_user_time": 2.316704, "process_kernel_time": 1.725462, "process_mem_max_rss": "199352", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:43:40.861519 [debug] [MainThread]: Command `dbt run` failed at 23:43:40.861421 after 1.47 seconds
[0m23:43:40.861777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772e23fb23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772dedab3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772e23e05350>]}
[0m23:43:40.862015 [debug] [MainThread]: Flushing usage events
[0m23:50:33.443609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d195e1349d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d195e137050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d195e1365d0>]}


============================== 23:50:33.445879 | 63d7ca61-7864-4104-b7a0-078e4185889d ==============================
[0m23:50:33.445879 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:50:33.446270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:50:34.066250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63d7ca61-7864-4104-b7a0-078e4185889d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d192d673f90>]}
[0m23:50:34.103661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63d7ca61-7864-4104-b7a0-078e4185889d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d195fe67cd0>]}
[0m23:50:34.104289 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m23:50:34.112350 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:50:34.112932 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:50:34.113255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63d7ca61-7864-4104-b7a0-078e4185889d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1927dfbc50>]}
[0m23:50:34.830462 [error] [MainThread]: Encountered an error:
Compilation Error in model node_evals (models/node_evals.sql)
  expected token ',', got 'node_name'
    line 11
      unique_key=['run_id', 'thread_id', 'turn_index', 'node_name'] -- Added node_name for uniqueness
[0m23:50:34.831661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4202697, "process_user_time": 2.251603, "process_kernel_time": 1.751589, "process_mem_max_rss": "199952", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:50:34.832178 [debug] [MainThread]: Command `dbt run` failed at 23:50:34.832067 after 1.42 seconds
[0m23:50:34.832472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d195e12a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d195df7ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1927b2c3d0>]}
[0m23:50:34.832754 [debug] [MainThread]: Flushing usage events
[0m23:54:51.371609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33c9add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33ac6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33ae2410>]}


============================== 23:54:51.373934 | a88dede7-95e6-488f-8f92-4c300647001f ==============================
[0m23:54:51.373934 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:54:51.374404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:51.987049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88dede7-95e6-488f-8f92-4c300647001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfd983190>]}
[0m23:54:52.023062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88dede7-95e6-488f-8f92-4c300647001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe359cba90>]}
[0m23:54:52.023714 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m23:54:52.030439 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:54:52.031408 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:54:52.031706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a88dede7-95e6-488f-8f92-4c300647001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfdc5c750>]}
[0m23:54:52.725805 [error] [MainThread]: Encountered an error:
Compilation Error in model retrieved_docs (models/retrieved_docs.sql)
  expected token ',', got 'unique_key'
    line 11
      unique_key=['run_id', 'thread_id', 'turn_index']
[0m23:54:52.726826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3865933, "process_user_time": 2.220515, "process_kernel_time": 1.731922, "process_mem_max_rss": "200148", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:54:52.727231 [debug] [MainThread]: Command `dbt run` failed at 23:54:52.727149 after 1.39 seconds
[0m23:54:52.727500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33c8e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33af63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdfd766d10>]}
[0m23:54:52.727725 [debug] [MainThread]: Flushing usage events
[0m23:55:47.763885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2df4e4ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2df54ef350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2df51f34d0>]}


============================== 23:55:47.765969 | a67888b8-bf7b-49bd-a161-d5fabb28eb2f ==============================
[0m23:55:47.765969 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:55:47.766406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:55:48.389126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a67888b8-bf7b-49bd-a161-d5fabb28eb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2dc6a4fbd0>]}
[0m23:55:48.424412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a67888b8-bf7b-49bd-a161-d5fabb28eb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2df6b901d0>]}
[0m23:55:48.425034 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m23:55:48.431674 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:55:48.432141 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:55:48.432407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a67888b8-bf7b-49bd-a161-d5fabb28eb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2dbea1c6d0>]}
[0m23:55:49.122057 [error] [MainThread]: Encountered an error:
Compilation Error in model node_evals (models/node_evals.sql)
  expected token ',', got 'node_name'
    line 11
      unique_key=['run_id', 'thread_id', 'turn_index', 'node_name'] -- Added node_name for uniqueness
[0m23:55:49.123056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3906109, "process_user_time": 2.138891, "process_kernel_time": 1.824816, "process_mem_max_rss": "200720", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m23:55:49.123510 [debug] [MainThread]: Command `dbt run` failed at 23:55:49.123418 after 1.39 seconds
[0m23:55:49.123816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2df4c95b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2df4e426d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2dbe8f81d0>]}
[0m23:55:49.124055 [debug] [MainThread]: Flushing usage events
[0m23:56:23.786087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc04849d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc02c8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc02c8d90>]}


============================== 23:56:23.788693 | a56e02e0-8079-4bce-9b78-79d04e5028cb ==============================
[0m23:56:23.788693 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:56:23.789112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:24.404492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b8a247710>]}
[0m23:56:24.440227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b8a492b50>]}
[0m23:56:24.440857 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m23:56:24.447642 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:56:24.448059 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:56:24.448298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b8a0a8550>]}
[0m23:56:25.270114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b89f74110>]}
[0m23:56:25.352406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b89ccb950>]}
[0m23:56:25.352852 [info ] [MainThread]: Found 3 models, 1 source, 469 macros
[0m23:56:25.353188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b89eea650>]}
[0m23:56:25.354666 [info ] [MainThread]: 
[0m23:56:25.355192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:56:25.358571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_subtle-poet-311614'
[0m23:56:25.358889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:25.818265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_subtle-poet-311614, now create_subtle-poet-311614_analytics)
[0m23:56:25.818826 [debug] [ThreadPool]: Creating schema "database: "subtle-poet-311614"
schema: "analytics"
"
[0m23:56:25.825627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:25.826100 [debug] [ThreadPool]: On create_subtle-poet-311614_analytics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "connection_name": "create_subtle-poet-311614_analytics"} */
create schema if not exists `subtle-poet-311614`.`analytics`
  
[0m23:56:26.152544 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:e1a7ed7b-a645-4b7f-b270-276a8ea77ec2&page=queryresults
[0m23:56:27.330519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_subtle-poet-311614_analytics, now list_subtle-poet-311614_analytics)
[0m23:56:27.331202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:27.680511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b8a788e50>]}
[0m23:56:27.681072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:27.681303 [info ] [MainThread]: 
[0m23:56:27.689658 [debug] [Thread-1 (]: Began running node model.chatraghu_dbt.conversation_turns
[0m23:56:27.690042 [info ] [Thread-1 (]: 1 of 3 START sql incremental model analytics.conversation_turns ................ [RUN]
[0m23:56:27.690420 [debug] [Thread-2 (]: Began running node model.chatraghu_dbt.node_evals
[0m23:56:27.690918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_subtle-poet-311614_analytics, now model.chatraghu_dbt.conversation_turns)
[0m23:56:27.691312 [debug] [Thread-3 (]: Began running node model.chatraghu_dbt.retrieved_docs
[0m23:56:27.691773 [info ] [Thread-2 (]: 2 of 3 START sql incremental model analytics.node_evals ........................ [RUN]
[0m23:56:27.692322 [debug] [Thread-1 (]: Began compiling node model.chatraghu_dbt.conversation_turns
[0m23:56:27.692744 [info ] [Thread-3 (]: 3 of 3 START sql incremental model analytics.retrieved_docs .................... [RUN]
[0m23:56:27.693192 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.chatraghu_dbt.node_evals'
[0m23:56:27.699690 [debug] [Thread-1 (]: Writing injected SQL for node "model.chatraghu_dbt.conversation_turns"
[0m23:56:27.700162 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.chatraghu_dbt.retrieved_docs'
[0m23:56:27.700497 [debug] [Thread-2 (]: Began compiling node model.chatraghu_dbt.node_evals
[0m23:56:27.701029 [debug] [Thread-3 (]: Began compiling node model.chatraghu_dbt.retrieved_docs
[0m23:56:27.704173 [debug] [Thread-2 (]: Writing injected SQL for node "model.chatraghu_dbt.node_evals"
[0m23:56:27.706989 [debug] [Thread-3 (]: Writing injected SQL for node "model.chatraghu_dbt.retrieved_docs"
[0m23:56:27.708159 [debug] [Thread-3 (]: Began executing node model.chatraghu_dbt.retrieved_docs
[0m23:56:27.708534 [debug] [Thread-2 (]: Began executing node model.chatraghu_dbt.node_evals
[0m23:56:27.735324 [debug] [Thread-1 (]: Began executing node model.chatraghu_dbt.conversation_turns
[0m23:56:27.792579 [debug] [Thread-1 (]: Writing runtime sql for node "model.chatraghu_dbt.conversation_turns"
[0m23:56:27.793805 [debug] [Thread-3 (]: Writing runtime sql for node "model.chatraghu_dbt.retrieved_docs"
[0m23:56:27.798617 [debug] [Thread-2 (]: Writing runtime sql for node "model.chatraghu_dbt.node_evals"
[0m23:56:27.800264 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:56:27.800639 [debug] [Thread-2 (]: On model.chatraghu_dbt.node_evals: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.node_evals"} */

  
    

    create or replace table `subtle-poet-311614`.`analytics`.`node_evals`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/node_evals.sql
-- This model unnests the evaluations array to create one row per node evaluation.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.timestamp_start,
    t.graph_version,
    eval.* EXCEPT (explanation)
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.evaluations) AS eval


    );
  
[0m23:56:27.802340 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:56:27.802700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:27.803132 [debug] [Thread-3 (]: On model.chatraghu_dbt.retrieved_docs: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.retrieved_docs"} */

  
    

    create or replace table `subtle-poet-311614`.`analytics`.`retrieved_docs`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/retrieved_docs.sql
-- This model unnests the retrieved_docs array to create one row per document.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.graph_version,
    t.timestamp_start,
    doc.content as doc_content,
    doc.score as doc_score,
    doc.metadata as doc_metadata
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.retrieved_docs) AS doc


    );
  
[0m23:56:27.803621 [debug] [Thread-1 (]: On model.chatraghu_dbt.conversation_turns: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.conversation_turns"} */

  
    

    create or replace table `subtle-poet-311614`.`analytics`.`conversation_turns`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/conversation_turns.sql
-- This model creates the main fact table with one row per conversation turn.



SELECT
    run_id,
    thread_id,
    turn_index,
    graph_version,
    timestamp_start,
    timestamp_end,
    query,
    response,
    total_latency_ms,
    graph_latency_ms,
    evaluation_latency_ms,
    graph_total_prompt_tokens,
    graph_total_completion_tokens,
    eval_total_prompt_tokens,
    eval_total_completion_tokens
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load`


    );
  
[0m23:56:28.381572 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:1c64c075-ee13-4f4f-b831-e4bd6c199b55&page=queryresults
[0m23:56:28.387810 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:923a5992-cdd2-49f8-a291-ec6c8ed35ae7&page=queryresults
[0m23:56:28.401729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:94517f45-e129-4fb4-905b-52cc27d81bc8&page=queryresults
[0m23:56:28.502120 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Cannot access field content on a value with type STRING at [24:9]; reason: invalidQuery, location: query, message: Cannot access field content on a value with type STRING at [24:9]')
[0m23:56:29.627677 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:ffad388e-3625-4d23-9e42-e94df5269283&page=queryresults
[0m23:56:29.721635 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:ffad388e-3625-4d23-9e42-e94df5269283&page=queryresults
[0m23:56:29.728343 [debug] [Thread-3 (]: Database Error in model retrieved_docs (models/retrieved_docs.sql)
  Cannot access field content on a value with type STRING at [24:9]
  compiled Code at target/run/chatraghu_dbt/models/retrieved_docs.sql
[0m23:56:29.729485 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b893a5a50>]}
[0m23:56:29.729989 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model analytics.retrieved_docs ........... [[31mERROR[0m in 2.03s]
[0m23:56:29.730493 [debug] [Thread-3 (]: Finished running node model.chatraghu_dbt.retrieved_docs
[0m23:56:30.263710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b89353610>]}
[0m23:56:30.264254 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model analytics.node_evals ................... [[32mCREATE TABLE (4.0 rows, 442.0 Bytes processed)[0m in 2.57s]
[0m23:56:30.264677 [debug] [Thread-2 (]: Finished running node model.chatraghu_dbt.node_evals
[0m23:56:30.356405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56e02e0-8079-4bce-9b78-79d04e5028cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6b89dfb090>]}
[0m23:56:30.357100 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model analytics.conversation_turns ........... [[32mCREATE TABLE (2.0 rows, 699.0 Bytes processed)[0m in 2.67s]
[0m23:56:30.357729 [debug] [Thread-1 (]: Finished running node model.chatraghu_dbt.conversation_turns
[0m23:56:30.359734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:30.359929 [debug] [MainThread]: Connection 'model.chatraghu_dbt.conversation_turns' was properly closed.
[0m23:56:30.360062 [debug] [MainThread]: Connection 'model.chatraghu_dbt.node_evals' was properly closed.
[0m23:56:30.360181 [debug] [MainThread]: Connection 'model.chatraghu_dbt.retrieved_docs' was properly closed.
[0m23:56:30.360458 [info ] [MainThread]: 
[0m23:56:30.360682 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m23:56:30.361403 [debug] [MainThread]: Command end result
[0m23:56:30.381449 [info ] [MainThread]: 
[0m23:56:30.381871 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:56:30.382160 [info ] [MainThread]: 
[0m23:56:30.382499 [error] [MainThread]:   Database Error in model retrieved_docs (models/retrieved_docs.sql)
  Cannot access field content on a value with type STRING at [24:9]
  compiled Code at target/run/chatraghu_dbt/models/retrieved_docs.sql
[0m23:56:30.382769 [info ] [MainThread]: 
[0m23:56:30.382990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:56:30.383973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.628613, "process_user_time": 2.624912, "process_kernel_time": 1.80188, "process_mem_max_rss": "211004", "process_out_blocks": "3032", "command_success": false, "process_in_blocks": "0"}
[0m23:56:30.384339 [debug] [MainThread]: Command `dbt run` failed at 23:56:30.384270 after 6.63 seconds
[0m23:56:30.384584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc047a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc02c9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6bc02c8a90>]}
[0m23:56:30.384799 [debug] [MainThread]: Flushing usage events
[0m02:14:23.579315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc04c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc04c6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc04c5c10>]}


============================== 02:14:23.581582 | 45d256e6-e574-4463-ac18-bc4300256e7e ==============================
[0m02:14:23.581582 [info ] [MainThread]: Running with dbt=1.8.0
[0m02:14:23.582112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:14:23.654423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45d256e6-e574-4463-ac18-bc4300256e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc0340dd0>]}
[0m02:14:23.670529 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12469615, "process_user_time": 0.872937, "process_kernel_time": 0.128137, "process_mem_max_rss": "88560", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m02:14:23.670955 [debug] [MainThread]: Command `dbt clean` succeeded at 02:14:23.670879 after 0.13 seconds
[0m02:14:23.671231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc07e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc03400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc030e0d0>]}
[0m02:14:23.671491 [debug] [MainThread]: Flushing usage events
[0m02:14:30.065206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e03cec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e0773250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e07737d0>]}


============================== 02:14:30.067301 | 26b1e1ec-7963-4286-b9e0-c939e2a33f3e ==============================
[0m02:14:30.067301 [info ] [MainThread]: Running with dbt=1.8.0
[0m02:14:30.067695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:14:30.678355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1aa17ce10>]}
[0m02:14:30.713823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e2127e10>]}
[0m02:14:30.714474 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m02:14:30.722552 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m02:14:30.723098 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:14:30.723374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1aa113c10>]}
[0m02:14:31.579239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a9e5d5d0>]}
[0m02:14:31.638784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a9e6dc50>]}
[0m02:14:31.639173 [info ] [MainThread]: Found 3 models, 1 source, 469 macros
[0m02:14:31.639414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a9e07f50>]}
[0m02:14:31.640613 [info ] [MainThread]: 
[0m02:14:31.641016 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:14:31.643914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_subtle-poet-311614'
[0m02:14:31.644180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:32.101639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_subtle-poet-311614, now list_subtle-poet-311614_analytics)
[0m02:14:32.102134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:14:32.405641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a9fad250>]}
[0m02:14:32.406477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:14:32.406865 [info ] [MainThread]: 
[0m02:14:32.412045 [debug] [Thread-1 (]: Began running node model.chatraghu_dbt.conversation_turns
[0m02:14:32.412403 [info ] [Thread-1 (]: 1 of 3 START sql incremental model analytics.conversation_turns ................ [RUN]
[0m02:14:32.412736 [debug] [Thread-2 (]: Began running node model.chatraghu_dbt.node_evals
[0m02:14:32.413078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_subtle-poet-311614_analytics, now model.chatraghu_dbt.conversation_turns)
[0m02:14:32.413350 [debug] [Thread-3 (]: Began running node model.chatraghu_dbt.retrieved_docs
[0m02:14:32.413871 [info ] [Thread-2 (]: 2 of 3 START sql incremental model analytics.node_evals ........................ [RUN]
[0m02:14:32.414300 [debug] [Thread-1 (]: Began compiling node model.chatraghu_dbt.conversation_turns
[0m02:14:32.414722 [info ] [Thread-3 (]: 3 of 3 START sql incremental model analytics.retrieved_docs .................... [RUN]
[0m02:14:32.415133 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.chatraghu_dbt.node_evals'
[0m02:14:32.422624 [debug] [Thread-1 (]: Writing injected SQL for node "model.chatraghu_dbt.conversation_turns"
[0m02:14:32.422990 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.chatraghu_dbt.retrieved_docs'
[0m02:14:32.423300 [debug] [Thread-2 (]: Began compiling node model.chatraghu_dbt.node_evals
[0m02:14:32.423750 [debug] [Thread-3 (]: Began compiling node model.chatraghu_dbt.retrieved_docs
[0m02:14:32.426588 [debug] [Thread-2 (]: Writing injected SQL for node "model.chatraghu_dbt.node_evals"
[0m02:14:32.429300 [debug] [Thread-3 (]: Writing injected SQL for node "model.chatraghu_dbt.retrieved_docs"
[0m02:14:32.430407 [debug] [Thread-1 (]: Began executing node model.chatraghu_dbt.conversation_turns
[0m02:14:32.430871 [debug] [Thread-3 (]: Began executing node model.chatraghu_dbt.retrieved_docs
[0m02:14:32.462973 [debug] [Thread-2 (]: Began executing node model.chatraghu_dbt.node_evals
[0m02:14:32.485276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:14:32.486788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:14:32.508722 [debug] [Thread-3 (]: Writing runtime sql for node "model.chatraghu_dbt.retrieved_docs"
[0m02:14:32.510743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:14:32.511085 [debug] [Thread-3 (]: On model.chatraghu_dbt.retrieved_docs: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.retrieved_docs"} */

  
    

    create or replace table `subtle-poet-311614`.`analytics`.`retrieved_docs`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/retrieved_docs.sql
-- This model unnests the retrieved_docs array to create one row per document.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.graph_version,
    t.timestamp_start,
    doc.content as doc_content,
    doc.score as doc_score,
    doc.metadata as doc_metadata
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.retrieved_docs) AS doc


    );
  
[0m02:14:32.794425 [debug] [Thread-2 (]: Writing runtime sql for node "model.chatraghu_dbt.node_evals"
[0m02:14:32.795107 [debug] [Thread-2 (]: On model.chatraghu_dbt.node_evals: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.node_evals"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `subtle-poet-311614`.`analytics`.`node_evals` as DBT_INTERNAL_DEST
        using (-- models/node_evals.sql
-- This model unnests the evaluations array to create one row per node evaluation.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.timestamp_start,
    t.graph_version,
    eval.* EXCEPT (explanation)
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.evaluations) AS eval


WHERE t.timestamp_start > (SELECT MAX(timestamp_start) FROM `subtle-poet-311614`.`analytics`.`node_evals`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.run_id = DBT_INTERNAL_DEST.run_id
                ) and (
                    DBT_INTERNAL_SOURCE.thread_id = DBT_INTERNAL_DEST.thread_id
                ) and (
                    DBT_INTERNAL_SOURCE.turn_index = DBT_INTERNAL_DEST.turn_index
                ) and (
                    DBT_INTERNAL_SOURCE.node_name = DBT_INTERNAL_DEST.node_name
                )

    
    when matched then update set
        `run_id` = DBT_INTERNAL_SOURCE.`run_id`,`thread_id` = DBT_INTERNAL_SOURCE.`thread_id`,`turn_index` = DBT_INTERNAL_SOURCE.`turn_index`,`timestamp_start` = DBT_INTERNAL_SOURCE.`timestamp_start`,`graph_version` = DBT_INTERNAL_SOURCE.`graph_version`,`handles_irrelevance` = DBT_INTERNAL_SOURCE.`handles_irrelevance`,`answer_relevance` = DBT_INTERNAL_SOURCE.`answer_relevance`,`follows_rules` = DBT_INTERNAL_SOURCE.`follows_rules`,`prompt_tokens` = DBT_INTERNAL_SOURCE.`prompt_tokens`,`persona_adherence` = DBT_INTERNAL_SOURCE.`persona_adherence`,`format_valid` = DBT_INTERNAL_SOURCE.`format_valid`,`classification` = DBT_INTERNAL_SOURCE.`classification`,`completion_tokens` = DBT_INTERNAL_SOURCE.`completion_tokens`,`node_name` = DBT_INTERNAL_SOURCE.`node_name`,`faithfulness` = DBT_INTERNAL_SOURCE.`faithfulness`,`evaluator_name` = DBT_INTERNAL_SOURCE.`evaluator_name`,`timestamp` = DBT_INTERNAL_SOURCE.`timestamp`,`context_relevance` = DBT_INTERNAL_SOURCE.`context_relevance`,`overall_success` = DBT_INTERNAL_SOURCE.`overall_success`
    

    when not matched then insert
        (`run_id`, `thread_id`, `turn_index`, `timestamp_start`, `graph_version`, `handles_irrelevance`, `answer_relevance`, `follows_rules`, `prompt_tokens`, `persona_adherence`, `format_valid`, `classification`, `completion_tokens`, `node_name`, `faithfulness`, `evaluator_name`, `timestamp`, `context_relevance`, `overall_success`)
    values
        (`run_id`, `thread_id`, `turn_index`, `timestamp_start`, `graph_version`, `handles_irrelevance`, `answer_relevance`, `follows_rules`, `prompt_tokens`, `persona_adherence`, `format_valid`, `classification`, `completion_tokens`, `node_name`, `faithfulness`, `evaluator_name`, `timestamp`, `context_relevance`, `overall_success`)


    
[0m02:14:32.834774 [debug] [Thread-1 (]: Writing runtime sql for node "model.chatraghu_dbt.conversation_turns"
[0m02:14:32.835389 [debug] [Thread-1 (]: On model.chatraghu_dbt.conversation_turns: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.conversation_turns"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `subtle-poet-311614`.`analytics`.`conversation_turns` as DBT_INTERNAL_DEST
        using (-- models/conversation_turns.sql
-- This model creates the main fact table with one row per conversation turn.



SELECT
    run_id,
    thread_id,
    turn_index,
    graph_version,
    timestamp_start,
    timestamp_end,
    query,
    response,
    total_latency_ms,
    graph_latency_ms,
    evaluation_latency_ms,
    graph_total_prompt_tokens,
    graph_total_completion_tokens,
    eval_total_prompt_tokens,
    eval_total_completion_tokens
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load`


-- This clause ensures we only process new data on subsequent runs
WHERE timestamp_start > (SELECT MAX(timestamp_start) FROM `subtle-poet-311614`.`analytics`.`conversation_turns`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.run_id = DBT_INTERNAL_DEST.run_id
                ) and (
                    DBT_INTERNAL_SOURCE.thread_id = DBT_INTERNAL_DEST.thread_id
                ) and (
                    DBT_INTERNAL_SOURCE.turn_index = DBT_INTERNAL_DEST.turn_index
                )

    
    when matched then update set
        `run_id` = DBT_INTERNAL_SOURCE.`run_id`,`thread_id` = DBT_INTERNAL_SOURCE.`thread_id`,`turn_index` = DBT_INTERNAL_SOURCE.`turn_index`,`graph_version` = DBT_INTERNAL_SOURCE.`graph_version`,`timestamp_start` = DBT_INTERNAL_SOURCE.`timestamp_start`,`timestamp_end` = DBT_INTERNAL_SOURCE.`timestamp_end`,`query` = DBT_INTERNAL_SOURCE.`query`,`response` = DBT_INTERNAL_SOURCE.`response`,`total_latency_ms` = DBT_INTERNAL_SOURCE.`total_latency_ms`,`graph_latency_ms` = DBT_INTERNAL_SOURCE.`graph_latency_ms`,`evaluation_latency_ms` = DBT_INTERNAL_SOURCE.`evaluation_latency_ms`,`graph_total_prompt_tokens` = DBT_INTERNAL_SOURCE.`graph_total_prompt_tokens`,`graph_total_completion_tokens` = DBT_INTERNAL_SOURCE.`graph_total_completion_tokens`,`eval_total_prompt_tokens` = DBT_INTERNAL_SOURCE.`eval_total_prompt_tokens`,`eval_total_completion_tokens` = DBT_INTERNAL_SOURCE.`eval_total_completion_tokens`
    

    when not matched then insert
        (`run_id`, `thread_id`, `turn_index`, `graph_version`, `timestamp_start`, `timestamp_end`, `query`, `response`, `total_latency_ms`, `graph_latency_ms`, `evaluation_latency_ms`, `graph_total_prompt_tokens`, `graph_total_completion_tokens`, `eval_total_prompt_tokens`, `eval_total_completion_tokens`)
    values
        (`run_id`, `thread_id`, `turn_index`, `graph_version`, `timestamp_start`, `timestamp_end`, `query`, `response`, `total_latency_ms`, `graph_latency_ms`, `evaluation_latency_ms`, `graph_total_prompt_tokens`, `graph_total_completion_tokens`, `eval_total_prompt_tokens`, `eval_total_completion_tokens`)


    
[0m02:14:32.994851 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:4f3c1e10-488e-4013-a016-3a2c2d5ca145&page=queryresults
[0m02:14:33.134358 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:0216ef80-3980-4bb8-89f7-11c68af81d7a&page=queryresults
[0m02:14:33.255136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:3568ab04-2c9c-434c-b869-9964e65c1a35&page=queryresults
[0m02:14:34.796401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a9d56510>]}
[0m02:14:34.797052 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model analytics.retrieved_docs ............... [[32mCREATE TABLE (0.0 rows, 108.0 Bytes processed)[0m in 2.37s]
[0m02:14:34.797525 [debug] [Thread-3 (]: Finished running node model.chatraghu_dbt.retrieved_docs
[0m02:14:35.230702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a8318310>]}
[0m02:14:35.231229 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model analytics.conversation_turns ........... [[32mMERGE (0.0 rows, 1.4 KiB processed)[0m in 2.82s]
[0m02:14:35.231773 [debug] [Thread-1 (]: Finished running node model.chatraghu_dbt.conversation_turns
[0m02:14:35.394717 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26b1e1ec-7963-4286-b9e0-c939e2a33f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1a9db7950>]}
[0m02:14:35.395266 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model analytics.node_evals ................... [[32mMERGE (0.0 rows, 992.0 Bytes processed)[0m in 2.98s]
[0m02:14:35.395733 [debug] [Thread-2 (]: Finished running node model.chatraghu_dbt.node_evals
[0m02:14:35.397673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:35.397971 [debug] [MainThread]: Connection 'model.chatraghu_dbt.conversation_turns' was properly closed.
[0m02:14:35.398115 [debug] [MainThread]: Connection 'model.chatraghu_dbt.node_evals' was properly closed.
[0m02:14:35.398253 [debug] [MainThread]: Connection 'model.chatraghu_dbt.retrieved_docs' was properly closed.
[0m02:14:35.398553 [info ] [MainThread]: 
[0m02:14:35.398841 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m02:14:35.399603 [debug] [MainThread]: Command end result
[0m02:14:35.420350 [info ] [MainThread]: 
[0m02:14:35.420753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:14:35.421041 [info ] [MainThread]: 
[0m02:14:35.421342 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:14:35.422186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.387663, "process_user_time": 2.640796, "process_kernel_time": 1.745948, "process_mem_max_rss": "209664", "process_out_blocks": "2920", "process_in_blocks": "0"}
[0m02:14:35.422543 [debug] [MainThread]: Command `dbt run` succeeded at 02:14:35.422476 after 5.39 seconds
[0m02:14:35.422757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e0212fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e18e7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba1e3b76650>]}
[0m02:14:35.422953 [debug] [MainThread]: Flushing usage events
[0m02:58:56.953912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528beeafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528c28f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528beeaf90>]}


============================== 02:58:56.956324 | 3bfca1a5-8f75-48ae-9349-f98ca6965762 ==============================
[0m02:58:56.956324 [info ] [MainThread]: Running with dbt=1.8.0
[0m02:58:56.956916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:58:57.584936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255bb4ed0>]}
[0m02:58:57.622649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528dc17ad0>]}
[0m02:58:57.623327 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m02:58:57.630849 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m02:58:57.710342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.710752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.732100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255c6bed0>]}
[0m02:58:57.859182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255b007d0>]}
[0m02:58:57.859624 [info ] [MainThread]: Found 3 models, 1 source, 469 macros
[0m02:58:57.859896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255ea1410>]}
[0m02:58:57.861329 [info ] [MainThread]: 
[0m02:58:57.861892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:58:57.865050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_subtle-poet-311614'
[0m02:58:57.865290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:58.331116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_subtle-poet-311614, now list_subtle-poet-311614_analytics)
[0m02:58:58.331672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:58.594833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255c553d0>]}
[0m02:58:58.595421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:58:58.595756 [info ] [MainThread]: 
[0m02:58:58.600156 [debug] [Thread-1 (]: Began running node model.chatraghu_dbt.conversation_turns
[0m02:58:58.600545 [debug] [Thread-2 (]: Began running node model.chatraghu_dbt.node_evals
[0m02:58:58.601087 [info ] [Thread-1 (]: 1 of 3 START sql incremental model analytics.conversation_turns ................ [RUN]
[0m02:58:58.601597 [debug] [Thread-3 (]: Began running node model.chatraghu_dbt.retrieved_docs
[0m02:58:58.602117 [info ] [Thread-2 (]: 2 of 3 START sql incremental model analytics.node_evals ........................ [RUN]
[0m02:58:58.602894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_subtle-poet-311614_analytics, now model.chatraghu_dbt.conversation_turns)
[0m02:58:58.603351 [info ] [Thread-3 (]: 3 of 3 START sql incremental model analytics.retrieved_docs .................... [RUN]
[0m02:58:58.603896 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.chatraghu_dbt.node_evals'
[0m02:58:58.604324 [debug] [Thread-1 (]: Began compiling node model.chatraghu_dbt.conversation_turns
[0m02:58:58.604805 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.chatraghu_dbt.retrieved_docs'
[0m02:58:58.605138 [debug] [Thread-2 (]: Began compiling node model.chatraghu_dbt.node_evals
[0m02:58:58.616677 [debug] [Thread-1 (]: Writing injected SQL for node "model.chatraghu_dbt.conversation_turns"
[0m02:58:58.617006 [debug] [Thread-3 (]: Began compiling node model.chatraghu_dbt.retrieved_docs
[0m02:58:58.620265 [debug] [Thread-2 (]: Writing injected SQL for node "model.chatraghu_dbt.node_evals"
[0m02:58:58.623710 [debug] [Thread-3 (]: Writing injected SQL for node "model.chatraghu_dbt.retrieved_docs"
[0m02:58:58.624560 [debug] [Thread-2 (]: Began executing node model.chatraghu_dbt.node_evals
[0m02:58:58.630221 [debug] [Thread-1 (]: Began executing node model.chatraghu_dbt.conversation_turns
[0m02:58:58.635729 [debug] [Thread-3 (]: Began executing node model.chatraghu_dbt.retrieved_docs
[0m02:58:58.665735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:58.667346 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:58:58.670216 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:58:58.975170 [debug] [Thread-3 (]: Writing runtime sql for node "model.chatraghu_dbt.retrieved_docs"
[0m02:58:58.977626 [debug] [Thread-1 (]: Writing runtime sql for node "model.chatraghu_dbt.conversation_turns"
[0m02:58:58.979200 [debug] [Thread-2 (]: Writing runtime sql for node "model.chatraghu_dbt.node_evals"
[0m02:58:58.980704 [debug] [Thread-1 (]: On model.chatraghu_dbt.conversation_turns: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.conversation_turns"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `subtle-poet-311614`.`analytics`.`conversation_turns` as DBT_INTERNAL_DEST
        using (-- models/conversation_turns.sql
-- This model creates the main fact table with one row per conversation turn.



SELECT
    run_id,
    thread_id,
    turn_index,
    graph_version,
    timestamp_start,
    timestamp_end,
    query,
    response,
    total_latency_ms,
    graph_latency_ms,
    evaluation_latency_ms,
    graph_total_prompt_tokens,
    graph_total_completion_tokens,
    eval_total_prompt_tokens,
    eval_total_completion_tokens
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load`


-- This clause ensures we only process new data on subsequent runs
WHERE timestamp_start > (SELECT MAX(timestamp_start) FROM `subtle-poet-311614`.`analytics`.`conversation_turns`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.run_id = DBT_INTERNAL_DEST.run_id
                ) and (
                    DBT_INTERNAL_SOURCE.thread_id = DBT_INTERNAL_DEST.thread_id
                ) and (
                    DBT_INTERNAL_SOURCE.turn_index = DBT_INTERNAL_DEST.turn_index
                )

    
    when matched then update set
        `run_id` = DBT_INTERNAL_SOURCE.`run_id`,`thread_id` = DBT_INTERNAL_SOURCE.`thread_id`,`turn_index` = DBT_INTERNAL_SOURCE.`turn_index`,`graph_version` = DBT_INTERNAL_SOURCE.`graph_version`,`timestamp_start` = DBT_INTERNAL_SOURCE.`timestamp_start`,`timestamp_end` = DBT_INTERNAL_SOURCE.`timestamp_end`,`query` = DBT_INTERNAL_SOURCE.`query`,`response` = DBT_INTERNAL_SOURCE.`response`,`total_latency_ms` = DBT_INTERNAL_SOURCE.`total_latency_ms`,`graph_latency_ms` = DBT_INTERNAL_SOURCE.`graph_latency_ms`,`evaluation_latency_ms` = DBT_INTERNAL_SOURCE.`evaluation_latency_ms`,`graph_total_prompt_tokens` = DBT_INTERNAL_SOURCE.`graph_total_prompt_tokens`,`graph_total_completion_tokens` = DBT_INTERNAL_SOURCE.`graph_total_completion_tokens`,`eval_total_prompt_tokens` = DBT_INTERNAL_SOURCE.`eval_total_prompt_tokens`,`eval_total_completion_tokens` = DBT_INTERNAL_SOURCE.`eval_total_completion_tokens`
    

    when not matched then insert
        (`run_id`, `thread_id`, `turn_index`, `graph_version`, `timestamp_start`, `timestamp_end`, `query`, `response`, `total_latency_ms`, `graph_latency_ms`, `evaluation_latency_ms`, `graph_total_prompt_tokens`, `graph_total_completion_tokens`, `eval_total_prompt_tokens`, `eval_total_completion_tokens`)
    values
        (`run_id`, `thread_id`, `turn_index`, `graph_version`, `timestamp_start`, `timestamp_end`, `query`, `response`, `total_latency_ms`, `graph_latency_ms`, `evaluation_latency_ms`, `graph_total_prompt_tokens`, `graph_total_completion_tokens`, `eval_total_prompt_tokens`, `eval_total_completion_tokens`)


    
[0m02:58:58.981237 [debug] [Thread-2 (]: On model.chatraghu_dbt.node_evals: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.node_evals"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `subtle-poet-311614`.`analytics`.`node_evals` as DBT_INTERNAL_DEST
        using (-- models/node_evals.sql
-- This model unnests the evaluations array to create one row per node evaluation.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.timestamp_start,
    t.graph_version,
    eval.* EXCEPT (explanation)
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.evaluations) AS eval


WHERE t.timestamp_start > (SELECT MAX(timestamp_start) FROM `subtle-poet-311614`.`analytics`.`node_evals`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.run_id = DBT_INTERNAL_DEST.run_id
                ) and (
                    DBT_INTERNAL_SOURCE.thread_id = DBT_INTERNAL_DEST.thread_id
                ) and (
                    DBT_INTERNAL_SOURCE.turn_index = DBT_INTERNAL_DEST.turn_index
                ) and (
                    DBT_INTERNAL_SOURCE.node_name = DBT_INTERNAL_DEST.node_name
                )

    
    when matched then update set
        `run_id` = DBT_INTERNAL_SOURCE.`run_id`,`thread_id` = DBT_INTERNAL_SOURCE.`thread_id`,`turn_index` = DBT_INTERNAL_SOURCE.`turn_index`,`timestamp_start` = DBT_INTERNAL_SOURCE.`timestamp_start`,`graph_version` = DBT_INTERNAL_SOURCE.`graph_version`,`handles_irrelevance` = DBT_INTERNAL_SOURCE.`handles_irrelevance`,`answer_relevance` = DBT_INTERNAL_SOURCE.`answer_relevance`,`follows_rules` = DBT_INTERNAL_SOURCE.`follows_rules`,`prompt_tokens` = DBT_INTERNAL_SOURCE.`prompt_tokens`,`persona_adherence` = DBT_INTERNAL_SOURCE.`persona_adherence`,`format_valid` = DBT_INTERNAL_SOURCE.`format_valid`,`classification` = DBT_INTERNAL_SOURCE.`classification`,`completion_tokens` = DBT_INTERNAL_SOURCE.`completion_tokens`,`node_name` = DBT_INTERNAL_SOURCE.`node_name`,`faithfulness` = DBT_INTERNAL_SOURCE.`faithfulness`,`evaluator_name` = DBT_INTERNAL_SOURCE.`evaluator_name`,`timestamp` = DBT_INTERNAL_SOURCE.`timestamp`,`context_relevance` = DBT_INTERNAL_SOURCE.`context_relevance`,`overall_success` = DBT_INTERNAL_SOURCE.`overall_success`
    

    when not matched then insert
        (`run_id`, `thread_id`, `turn_index`, `timestamp_start`, `graph_version`, `handles_irrelevance`, `answer_relevance`, `follows_rules`, `prompt_tokens`, `persona_adherence`, `format_valid`, `classification`, `completion_tokens`, `node_name`, `faithfulness`, `evaluator_name`, `timestamp`, `context_relevance`, `overall_success`)
    values
        (`run_id`, `thread_id`, `turn_index`, `timestamp_start`, `graph_version`, `handles_irrelevance`, `answer_relevance`, `follows_rules`, `prompt_tokens`, `persona_adherence`, `format_valid`, `classification`, `completion_tokens`, `node_name`, `faithfulness`, `evaluator_name`, `timestamp`, `context_relevance`, `overall_success`)


    
[0m02:58:58.984260 [debug] [Thread-3 (]: On model.chatraghu_dbt.retrieved_docs: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.retrieved_docs"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `subtle-poet-311614`.`analytics`.`retrieved_docs` as DBT_INTERNAL_DEST
        using (-- models/retrieved_docs.sql
-- This model unnests the retrieved_docs array to create one row per document.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.graph_version,
    t.timestamp_start,
    doc.content as doc_content,
    doc.score as doc_score,
    doc.metadata as doc_metadata
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.retrieved_docs) AS doc


WHERE t.timestamp_start > (SELECT MAX(timestamp_start) FROM `subtle-poet-311614`.`analytics`.`retrieved_docs`)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.run_id = DBT_INTERNAL_DEST.run_id
                ) and (
                    DBT_INTERNAL_SOURCE.thread_id = DBT_INTERNAL_DEST.thread_id
                ) and (
                    DBT_INTERNAL_SOURCE.turn_index = DBT_INTERNAL_DEST.turn_index
                )

    
    when matched then update set
        `run_id` = DBT_INTERNAL_SOURCE.`run_id`,`thread_id` = DBT_INTERNAL_SOURCE.`thread_id`,`turn_index` = DBT_INTERNAL_SOURCE.`turn_index`,`graph_version` = DBT_INTERNAL_SOURCE.`graph_version`,`timestamp_start` = DBT_INTERNAL_SOURCE.`timestamp_start`,`doc_content` = DBT_INTERNAL_SOURCE.`doc_content`,`doc_score` = DBT_INTERNAL_SOURCE.`doc_score`,`doc_metadata` = DBT_INTERNAL_SOURCE.`doc_metadata`
    

    when not matched then insert
        (`run_id`, `thread_id`, `turn_index`, `graph_version`, `timestamp_start`, `doc_content`, `doc_score`, `doc_metadata`)
    values
        (`run_id`, `thread_id`, `turn_index`, `graph_version`, `timestamp_start`, `doc_content`, `doc_score`, `doc_metadata`)


    
[0m02:58:59.295618 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:9fb215f7-f90e-47c5-9b4b-02eb99c4bf0f&page=queryresults
[0m02:58:59.332083 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:aeeff48a-b380-4761-b28f-2e880e1612e2&page=queryresults
[0m02:58:59.333995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:313076ba-4264-4212-9d63-4835973c7d0f&page=queryresults
[0m02:59:01.276759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528c17d910>]}
[0m02:59:01.277968 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model analytics.conversation_turns ........... [[32mMERGE (0.0 rows, 1.4 KiB processed)[0m in 2.67s]
[0m02:59:01.278494 [debug] [Thread-1 (]: Finished running node model.chatraghu_dbt.conversation_turns
[0m02:59:01.280220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255c56750>]}
[0m02:59:01.280628 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model analytics.retrieved_docs ............... [[32mMERGE (0.0 rows, 108.0 Bytes processed)[0m in 2.68s]
[0m02:59:01.281026 [debug] [Thread-3 (]: Finished running node model.chatraghu_dbt.retrieved_docs
[0m02:59:01.303684 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bfca1a5-8f75-48ae-9349-f98ca6965762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745255bc2d10>]}
[0m02:59:01.304248 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model analytics.node_evals ................... [[32mMERGE (0.0 rows, 992.0 Bytes processed)[0m in 2.70s]
[0m02:59:01.304684 [debug] [Thread-2 (]: Finished running node model.chatraghu_dbt.node_evals
[0m02:59:01.308055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:59:01.308329 [debug] [MainThread]: Connection 'model.chatraghu_dbt.conversation_turns' was properly closed.
[0m02:59:01.308465 [debug] [MainThread]: Connection 'model.chatraghu_dbt.node_evals' was properly closed.
[0m02:59:01.308585 [debug] [MainThread]: Connection 'model.chatraghu_dbt.retrieved_docs' was properly closed.
[0m02:59:01.308890 [info ] [MainThread]: 
[0m02:59:01.309172 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m02:59:01.309946 [debug] [MainThread]: Command end result
[0m02:59:01.328488 [info ] [MainThread]: 
[0m02:59:01.328831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:59:01.329110 [info ] [MainThread]: 
[0m02:59:01.329400 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:59:01.330315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4090433, "process_user_time": 1.949798, "process_kernel_time": 1.797031, "process_mem_max_rss": "204032", "process_out_blocks": "1984", "process_in_blocks": "0"}
[0m02:59:01.330651 [debug] [MainThread]: Command `dbt run` succeeded at 02:59:01.330586 after 4.41 seconds
[0m02:59:01.330867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528bd33610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74528bd31b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745245fc2d10>]}
[0m02:59:01.331082 [debug] [MainThread]: Flushing usage events
[0m03:27:07.945405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea0c3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9f04390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea46b490>]}


============================== 03:27:07.951626 | 44f7d996-7a56-4dcd-a800-47b0e39698f8 ==============================
[0m03:27:07.951626 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:27:07.952272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select retrieved_docs --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:27:08.992008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97b3dffd50>]}
[0m03:27:09.063110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ebe17d90>]}
[0m03:27:09.064072 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m03:27:09.086684 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m03:27:09.178029 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:27:09.178974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97eb680a10>]}
[0m03:27:10.553525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97b83d0850>]}
[0m03:27:10.657636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97b38460d0>]}
[0m03:27:10.658274 [info ] [MainThread]: Found 3 models, 1 source, 469 macros
[0m03:27:10.658710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97b3aa2050>]}
[0m03:27:10.661139 [info ] [MainThread]: 
[0m03:27:10.662033 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:27:10.663521 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_subtle-poet-311614'
[0m03:27:10.664210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:11.261177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_subtle-poet-311614, now list_subtle-poet-311614_dbt_raghu_dev)
[0m03:27:11.262962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:11.659336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97b3adbc90>]}
[0m03:27:11.661192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:27:11.662046 [info ] [MainThread]: 
[0m03:27:11.672787 [debug] [Thread-1 (]: Began running node model.chatraghu_dbt.retrieved_docs
[0m03:27:11.673511 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_raghu_dev.retrieved_docs ................ [RUN]
[0m03:27:11.674472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_subtle-poet-311614_dbt_raghu_dev, now model.chatraghu_dbt.retrieved_docs)
[0m03:27:11.675279 [debug] [Thread-1 (]: Began compiling node model.chatraghu_dbt.retrieved_docs
[0m03:27:11.689118 [debug] [Thread-1 (]: Writing injected SQL for node "model.chatraghu_dbt.retrieved_docs"
[0m03:27:11.690250 [debug] [Thread-1 (]: Began executing node model.chatraghu_dbt.retrieved_docs
[0m03:27:11.763133 [debug] [Thread-1 (]: Writing runtime sql for node "model.chatraghu_dbt.retrieved_docs"
[0m03:27:11.764337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:11.764902 [debug] [Thread-1 (]: On model.chatraghu_dbt.retrieved_docs: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.retrieved_docs"} */

  
    

    create or replace table `subtle-poet-311614`.`dbt_raghu_dev`.`retrieved_docs`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/retrieved_docs.sql
-- This model unnests the retrieved_docs array to create one row per document.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.graph_version,
    t.timestamp_start,
    doc.content as doc_content,
    CAST(doc.score AS FLOAT64) as doc_score,
    doc.metadata as doc_metadata
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.retrieved_docs) AS doc


    );
  
[0m03:27:12.375784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:9660588c-4cd4-4e17-83f7-ecd06c011310&page=queryresults
[0m03:27:12.377532 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.retrieved_docs"} */

  
    

    create or replace table `subtle-poet-311614`.`dbt_raghu_dev`.`retrieved_docs`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/retrieved_docs.sql
-- This model unnests the retrieved_docs array to create one row per document.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.graph_version,
    t.timestamp_start,
    doc.content as doc_content,
    CAST(doc.score AS FLOAT64) as doc_score,
    doc.metadata as doc_metadata
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.retrieved_docs) AS doc


    );
  
[0m03:27:12.378423 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset subtle-poet-311614:dbt_raghu_dev was not found in location us-east1; reason: notFound, message: Not found: Dataset subtle-poet-311614:dbt_raghu_dev was not found in location us-east1

Location: us-east1
Job ID: 9660588c-4cd4-4e17-83f7-ecd06c011310

[0m03:27:12.411955 [debug] [Thread-1 (]: Runtime Error in model retrieved_docs (models/retrieved_docs.sql)
  404 Not found: Dataset subtle-poet-311614:dbt_raghu_dev was not found in location us-east1; reason: notFound, message: Not found: Dataset subtle-poet-311614:dbt_raghu_dev was not found in location us-east1
  
  Location: us-east1
  Job ID: 9660588c-4cd4-4e17-83f7-ecd06c011310
  
[0m03:27:12.415385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f7d996-7a56-4dcd-a800-47b0e39698f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97b38c3e10>]}
[0m03:27:12.417170 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_raghu_dev.retrieved_docs ....... [[31mERROR[0m in 0.74s]
[0m03:27:12.418610 [debug] [Thread-1 (]: Finished running node model.chatraghu_dbt.retrieved_docs
[0m03:27:12.424546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:12.425035 [debug] [MainThread]: Connection 'model.chatraghu_dbt.retrieved_docs' was properly closed.
[0m03:27:12.426162 [info ] [MainThread]: 
[0m03:27:12.427101 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m03:27:12.428733 [debug] [MainThread]: Command end result
[0m03:27:12.476909 [info ] [MainThread]: 
[0m03:27:12.477843 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:27:12.478415 [info ] [MainThread]: 
[0m03:27:12.479145 [error] [MainThread]:   Runtime Error in model retrieved_docs (models/retrieved_docs.sql)
  404 Not found: Dataset subtle-poet-311614:dbt_raghu_dev was not found in location us-east1; reason: notFound, message: Not found: Dataset subtle-poet-311614:dbt_raghu_dev was not found in location us-east1
  
  Location: us-east1
  Job ID: 9660588c-4cd4-4e17-83f7-ecd06c011310
  
[0m03:27:12.479665 [info ] [MainThread]: 
[0m03:27:12.480787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:27:12.484213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.59814, "process_user_time": 4.054513, "process_kernel_time": 1.884605, "process_mem_max_rss": "204352", "process_in_blocks": "5760", "process_out_blocks": "2848", "command_success": false}
[0m03:27:12.485117 [debug] [MainThread]: Command `dbt run` failed at 03:27:12.484906 after 4.60 seconds
[0m03:27:12.485641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea0b6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9f25fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ed85a890>]}
[0m03:27:12.486158 [debug] [MainThread]: Flushing usage events
[0m03:28:05.369255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775767fde010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775767e23610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775767e216d0>]}


============================== 03:28:05.372463 | cc27b009-8487-41b6-b915-39066adfd787 ==============================
[0m03:28:05.372463 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:28:05.373081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select retrieved_docs --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:28:06.426647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775731dabb90>]}
[0m03:28:06.494589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775769d4c1d0>]}
[0m03:28:06.495700 [info ] [MainThread]: Registered adapter: bigquery=1.8.0
[0m03:28:06.507258 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m03:28:06.632492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:28:06.632978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:28:06.679385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775731b16510>]}
[0m03:28:06.909110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775731c000d0>]}
[0m03:28:06.910401 [info ] [MainThread]: Found 3 models, 1 source, 469 macros
[0m03:28:06.911572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775731c23050>]}
[0m03:28:06.915855 [info ] [MainThread]: 
[0m03:28:06.917136 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:28:06.918937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_subtle-poet-311614'
[0m03:28:06.919509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:07.482587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_subtle-poet-311614, now list_subtle-poet-311614_dbt_raghu_dev)
[0m03:28:07.484433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:28:07.876176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77576823f990>]}
[0m03:28:07.877575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:28:07.878298 [info ] [MainThread]: 
[0m03:28:07.889570 [debug] [Thread-1 (]: Began running node model.chatraghu_dbt.retrieved_docs
[0m03:28:07.891010 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_raghu_dev.retrieved_docs ................ [RUN]
[0m03:28:07.891971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_subtle-poet-311614_dbt_raghu_dev, now model.chatraghu_dbt.retrieved_docs)
[0m03:28:07.892329 [debug] [Thread-1 (]: Began compiling node model.chatraghu_dbt.retrieved_docs
[0m03:28:07.910177 [debug] [Thread-1 (]: Writing injected SQL for node "model.chatraghu_dbt.retrieved_docs"
[0m03:28:07.911005 [debug] [Thread-1 (]: Began executing node model.chatraghu_dbt.retrieved_docs
[0m03:28:07.998956 [debug] [Thread-1 (]: Writing runtime sql for node "model.chatraghu_dbt.retrieved_docs"
[0m03:28:08.000116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:08.001042 [debug] [Thread-1 (]: On model.chatraghu_dbt.retrieved_docs: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "chatraghu_dbt", "target_name": "dev", "node_id": "model.chatraghu_dbt.retrieved_docs"} */

  
    

    create or replace table `subtle-poet-311614`.`dbt_raghu_dev`.`retrieved_docs`
      
    partition by timestamp_trunc(timestamp_start, day)
    

    OPTIONS()
    as (
      -- models/retrieved_docs.sql
-- This model unnests the retrieved_docs array to create one row per document.



SELECT
    t.run_id,
    t.thread_id,
    t.turn_index,
    t.graph_version,
    t.timestamp_start,
    doc.content as doc_content,
    CAST(doc.score AS FLOAT64) as doc_score,
    doc.metadata as doc_metadata
FROM
    `subtle-poet-311614`.`staging_eval_results_raw`.`daily_load` AS t,
    UNNEST(t.retrieved_docs) AS doc


    );
  
[0m03:28:08.797940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=subtle-poet-311614&j=bq:us-east1:5b48f1cf-56b1-4b5f-9547-957c91f836c9&page=queryresults
[0m03:28:11.071324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc27b009-8487-41b6-b915-39066adfd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775731c022d0>]}
[0m03:28:11.072501 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_raghu_dev.retrieved_docs ........... [[32mCREATE TABLE (3.0 rows, 3.9 KiB processed)[0m in 3.18s]
[0m03:28:11.073700 [debug] [Thread-1 (]: Finished running node model.chatraghu_dbt.retrieved_docs
[0m03:28:11.077571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:28:11.077937 [debug] [MainThread]: Connection 'model.chatraghu_dbt.retrieved_docs' was properly closed.
[0m03:28:11.078300 [info ] [MainThread]: 
[0m03:28:11.078976 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m03:28:11.079903 [debug] [MainThread]: Command end result
[0m03:28:11.110368 [info ] [MainThread]: 
[0m03:28:11.111196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:28:11.111720 [info ] [MainThread]: 
[0m03:28:11.112357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:28:11.114479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.804095, "process_user_time": 3.216098, "process_kernel_time": 1.850357, "process_mem_max_rss": "197204", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m03:28:11.115154 [debug] [MainThread]: Command `dbt run` succeeded at 03:28:11.115003 after 5.80 seconds
[0m03:28:11.115695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77576b690bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775733722550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77576b776850>]}
[0m03:28:11.116181 [debug] [MainThread]: Flushing usage events
